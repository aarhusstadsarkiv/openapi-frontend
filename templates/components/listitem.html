{#
    Single listitem, generated from the minimal listview of a record, returned by
    the search-service. Only used by '/search'
    Uses the 'record'-variable from the template-context
#}

<a href="/resources/records/{{record.id}}">
    {% if record.thumbnail %}
        <div>
            {# {% if record.availability|int > 3 or readingroom or session.get('is_employee') %} #}
            {% if record.availability|int > 3 %}
                <img src="{{record.thumbnail}}">
            {% else %}
                <div>
                    <p>Materialet kan ses på læsesalen</p>
                </div>
            {% endif %}
        </div>
    {% endif %}

    <div>
        {% if record.label %}
            <h3 class="listitem-heading">{{record.label|truncate(200)}}</h3>
        {% endif %}

        {% if record.summary %}
            <p class="listitem-summary">{{record.summary|truncate(300)}}</p>
        {% endif %}

        {% if not (record.summary or record.label) %}
            {% if record.desc_notes %}
                <p class="listitem-summary">{{record.desc_notes|truncate(300)}}</p>
            {% else %}
                <p class="listitem-summary">Materialet er ikke beskrevet</p>
            {% endif %}
        {% endif %}

        {% if record.collectors_label %}
            <p class="listitem-collector">{{record.collectors_label}}</p>
        {% endif %}

        {# TODO: Not returned by cloudsearch yet
        {% if record.series %}
            <p class="listitem-series">{{'/'.join(record.series)}}</p>
        {% endif %}
        #}
        {% if record.content_types %}
            <p class="listitem-content_type">
                <span>{{record.content_types[0]}}</span>
            </p>
        {% endif %}

        <p class="listitem-date">
        {% if record.date_from %}
            {% if record.date_to %}
                {% if record.date_to == record.date_from %}
                    <span>{{record.date_from[0:4]}}-{{record.date_from[4:6]}}-{{record.date_from[6:8]}}</span>
                {% elif record.date_from[0:6] == record.date_to[0:6] %}
                    <span>{{record.date_from[0:4]}}-{{record.date_from[4:6]}}</span>
                {% elif record.date_from[0:4] == record.date_to[0:4] and record.date_from[4:8] == '0101' %}
                    <span>{{record.date_from[0:4]}}</span>
                {% elif record.date_from[4:8] == '0101' and record.date_to[4:8] == '1231' %}
                    <span>{{record.date_from[0:4]}} ~ {{record.date_to[0:4]}}</span>
                {% else %}
                    <span>{{record.date_from[0:4]}}-{{record.date_from[4:6]}}-{{record.date_from[6:8]}} ~ {{record.date_to[0:4]}}-{{record.date_to[4:6]}}-{{record.date_to[6:8]}}</span>
                {% endif %}
            {% else %}
                <span>{{record.date_from[0:4]}}-{{record.date_from[4:6]}}-{{record.date_from[6:8]}} ~</span>
            {% endif %}
        {% elif record.date_to %}
            <span>~ {{record.date_to[0:4]}}-{{record.date_to[4:6]}}-{{record.date_to[6:8]}}</span>
        {% else %}
            <span>Uden datering</span>
        {% endif %}
        </p>
    </div>
</a>